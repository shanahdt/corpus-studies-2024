<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Corpus Studies in Music - Week 7: Classifying</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../class_notes/week_6.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../site_libs/datatables-binding-0.27/datatables.js"></script>
<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<meta property="og:title" content="Corpus Studies in Music - Week 7: Classifying">
<meta property="og:description" content="">
<meta property="og:image" content="https://shanahdt.github.io/corpus-studies-2024/class_notes/week_7_files/figure-html/unnamed-chunk-6-1.png">
<meta property="og:site-name" content="Corpus Studies in Music">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../class_notes/week_1.html">Class Notes</a></li><li class="breadcrumb-item"><a href="../class_notes/week_7.html">Week 7: Classifying</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Corpus Studies in Music</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Resources</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../course-schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../some-troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Some Troubleshooting</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Class Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1: Representing Musical Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2: Melodic and Harmonic Intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3: Data Analysis, Time, Cadences, Phrases, <em>etc.</em></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 4: Conceptual Debates (Key-Finding, Entropy, etc.)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5: Practicing with Spotify</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 6: Regression and Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../class_notes/week_7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Week 7: Classifying</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#this-weeks-plan" id="toc-this-weeks-plan" class="nav-link active" data-scroll-target="#this-weeks-plan">This Week’s Plan</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting Started</a></li>
  <li><a href="#pca-and-authorship" id="toc-pca-and-authorship" class="nav-link" data-scroll-target="#pca-and-authorship">PCA and Authorship</a></li>
  <li><a href="#classifiers" id="toc-classifiers" class="nav-link" data-scroll-target="#classifiers">Classifiers</a></li>
  <li><a href="#returning-to-our-christmas-song-problem" id="toc-returning-to-our-christmas-song-problem" class="nav-link" data-scroll-target="#returning-to-our-christmas-song-problem">Returning to our Christmas Song Problem</a>
  <ul class="collapse">
  <li><a href="#what-is-the-model-using" id="toc-what-is-the-model-using" class="nav-link" data-scroll-target="#what-is-the-model-using">What is the model using?</a></li>
  </ul></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  </ul></li>
  <li><a href="#john-or-paul" id="toc-john-or-paul" class="nav-link" data-scroll-target="#john-or-paul">John or Paul?</a>
  <ul class="collapse">
  <li><a href="#getting-the-data" id="toc-getting-the-data" class="nav-link" data-scroll-target="#getting-the-data">Getting the Data</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation">Cross-Validation</a>
  <ul class="collapse">
  <li><a href="#k-folds-cross-validation" id="toc-k-folds-cross-validation" class="nav-link" data-scroll-target="#k-folds-cross-validation">K-folds cross validation:</a></li>
  </ul></li>
  <li><a href="#other-models" id="toc-other-models" class="nav-link" data-scroll-target="#other-models">Other Models</a>
  <ul class="collapse">
  <li><a href="#neural-net" id="toc-neural-net" class="nav-link" data-scroll-target="#neural-net">Neural Net</a></li>
  </ul></li>
  <li><a href="#comparing-models" id="toc-comparing-models" class="nav-link" data-scroll-target="#comparing-models">Comparing Models</a>
  <ul class="collapse">
  <li><a href="#grabbing-beatles-data" id="toc-grabbing-beatles-data" class="nav-link" data-scroll-target="#grabbing-beatles-data">Grabbing Beatles Data</a></li>
  <li><a href="#predicting" id="toc-predicting" class="nav-link" data-scroll-target="#predicting">Predicting</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#exercise-1" id="toc-exercise-1" class="nav-link" data-scroll-target="#exercise-1">Exercise:</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/shanahdt/corpus-studies-2024/edit/main/class_notes/week_7.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/shanahdt/corpus-studies-2024/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 7: Classifying</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="this-weeks-plan" class="level1">
<h1>This Week’s Plan</h1>
<ul>
<li>Look at running a principal components analysis for authorship</li>
<li>Work on some models for classifying data</li>
<li>Discuss how we might evaluate our models</li>
</ul>
<p>This week, we will start by moving from clustering to PCA, or pricinpal components analysis. PCA is often seen as a way of reducing the dimensions of features, and here we will explore what it looks like when exploring questions of authorship.</p>
<p>We will follow this by looking at what it means to train a classifier, and some of the research questions we might ask of a classifier.</p>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting Started</h2>
<p>We will be using a of libraries today:</p>
</section>
<section id="pca-and-authorship" class="level2">
<h2 class="anchored" data-anchor-id="pca-and-authorship">PCA and Authorship</h2>
<p>PCAs are often used for reducing dimensions when we have lots of variables but a model might be better suited from combining those variables. PCAs have also been used a fair bit to explore questions of authorship. Here we have a question of authorship using symbolic data taken from scores. We are trying to explore the music of Josquin.</p>
<p>Here we load the data in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># complete_data &lt;- read_csv(here("data", "attribution_data_new.csv", na.strings=c("","NA", header=T)))</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/attribution_data_new.csv"</span>, <span class="at">na.strings=</span><span class="fu">c</span>(<span class="st">""</span>,<span class="st">"NA"</span>), <span class="at">header=</span>T)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> complete_data[,<span class="sc">-</span><span class="dv">62</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jesse Rodin’s <em>Josquin Research Project</em> has given levels of security for attribution, including pieces that we know are Josquin’s, those we think might be, and those which are more questionable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Josquin attribution level 1 and palestrina</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>josquin <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">'Josquin des Prez'</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>josquin_secure <span class="ot">&lt;-</span> josquin[josquin<span class="sc">$</span>Attribution.Level <span class="sc">&lt;=</span> <span class="dv">2</span> ,]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>josquin_secure<span class="sc">$</span>Composer <span class="ot">&lt;-</span> <span class="fu">as.character</span>(josquin_secure<span class="sc">$</span>Composer)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>josquin_less_secure <span class="ot">&lt;-</span> josquin[ josquin<span class="sc">$</span>Attribution.Level <span class="sc">&gt;=</span> <span class="dv">3</span>,]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="do">####Other composers</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>bach <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">"Bach_Johann Sebastian"</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>larue <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">"la Rue_Pierre de"</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>palestrina <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">"Palestrina_Giovanni Perluigi da"</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ockeghem <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">"Johannes Ockeghem"</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>orto <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">"de Orto_Marbrianus"</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>dufay <span class="ot">&lt;-</span> complete_data[complete_data<span class="sc">$</span>Composer <span class="sc">==</span> <span class="st">"Du Fay_Guillaume"</span>,<span class="sc">-</span><span class="dv">12</span>]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>josquin_bach <span class="ot">&lt;-</span> <span class="fu">rbind</span>(josquin_secure, bach)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>josquin_palestrina <span class="ot">&lt;-</span> <span class="fu">rbind</span>(josquin_secure, palestrina)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>josquin_larue <span class="ot">&lt;-</span> <span class="fu">rbind</span>(josquin_secure, larue)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">rbind</span>(josquin_secure, dufay)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-warnings="false">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>columns_wanted <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">11</span>)  </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Matrix <span class="ot">&lt;-</span> comparison[,columns_wanted]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Matrix)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Matrix[<span class="fu">is.na</span>(Matrix)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># log.pieces &lt;- log(Matrix)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>log.pieces <span class="ot">&lt;-</span> <span class="fu">log</span>(Matrix)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>composer <span class="ot">&lt;-</span> comparison[,<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code runs the actual principal components analysis.</p>
<p>It also provides a scree plot, allowing us to see which components are the most heavily weighted. This can allow us to reduce the dimensions as we see fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">####principle component analysis.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>pieces.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(Matrix,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">center =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scale. =</span> <span class="cn">TRUE</span>) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pieces.pca, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">main=</span><span class="st">"Principal Components Analysis"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It’s worth taking some time to explore what each of these components actually means and how they’re weighted. PCA is weighting instances of parallel motion and similar motion pretty heavily, but negatively weighting pitch entropy and oblique motion. PC2 seems to be looking at nPVI and 9-8 suspensions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pieces.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviations (1, .., p=7):
[1] 1.3651251 1.1932956 1.0473249 0.9758057 0.8158066 0.7627338 0.6450502

Rotation (n x k) = (7 x 7):
                         PC1         PC2         PC3         PC4         PC5
nPVI_Entire       -0.1534310  0.28077115 -0.77204065  0.00852347  0.47773321
Nine_Eight        -0.1018707  0.59859586  0.02341681  0.52670532 -0.12881933
pitch_correlation -0.1550940  0.39505005  0.02896214 -0.83452001 -0.15900704
pitch_entropy     -0.1600989  0.50110624  0.56438102  0.04875023  0.32761392
parallel_motion    0.4600560  0.38613864 -0.26230330 -0.01533229 -0.49612767
similar_motion     0.6300842  0.05699415  0.06600453  0.03642203 -0.03731014
oblique_motion    -0.5547412 -0.05768156 -0.10430981  0.14881862 -0.61239508
                         PC6         PC7
nPVI_Entire       -0.2145105 -0.16511611
Nine_Eight         0.5736302 -0.08770651
pitch_correlation  0.2642076 -0.16592149
pitch_entropy     -0.5428772  0.01765806
parallel_motion   -0.3378146  0.45819860
similar_motion    -0.1086246 -0.76214894
oblique_motion    -0.3667346 -0.38260361</code></pre>
</div>
</div>
<p>As we can see, about 65% of the variance is accounted for with the first two principal components:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pieces.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2    PC3    PC4     PC5     PC6     PC7
Standard deviation     1.3651 1.1933 1.0473 0.9758 0.81581 0.76273 0.64505
Proportion of Variance 0.2662 0.2034 0.1567 0.1360 0.09508 0.08311 0.05944
Cumulative Proportion  0.2662 0.4697 0.6263 0.7624 0.85745 0.94056 1.00000</code></pre>
</div>
</div>
<p>Plotting our two composers with the first two principal components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggbiplot</span>(pieces.pca, <span class="at">obs.scale =</span> <span class="dv">1</span>, <span class="at">var.scale =</span> <span class="dv">1</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">groups =</span> composer, <span class="at">ellipse =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">circle =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">''</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.direction =</span> <span class="st">'horizontal'</span>, </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">legend.position =</span> <span class="st">'top'</span>) <span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">theme_bw</span>()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can change the number of components</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># seven_component_model &lt;- data.frame(pieces.pca$x[,1:8])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also look at how much each of these features is being weighted within the first two components.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>circle <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">cos</span>(theta), <span class="at">y =</span> <span class="fu">sin</span>(theta))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(circle,<span class="fu">aes</span>(x,y)) <span class="sc">+</span> <span class="fu">geom_path</span>()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>loadings <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pieces.pca<span class="sc">$</span>rotation, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">.names =</span> <span class="fu">row.names</span>(pieces.pca<span class="sc">$</span>rotation))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="at">data=</span>loadings, </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">label =</span> .names, <span class="at">colour =</span> .names)) <span class="sc">+</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"PC1"</span>, <span class="at">y =</span> <span class="st">"PC2"</span>) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="classifiers" class="level2">
<h2 class="anchored" data-anchor-id="classifiers">Classifiers</h2>
<p>A classifier is a model that assigns a label to data based on the input. There are many types of classifiers, and we will be evaluating various models throughout the week. Our goal will be to train a model on the features generally associated with a category, and then test the accuracy of that model. For now, a good starting point might be our Christmas Song question from last week.</p>
</section>
<section id="returning-to-our-christmas-song-problem" class="level2">
<h2 class="anchored" data-anchor-id="returning-to-our-christmas-song-problem">Returning to our Christmas Song Problem</h2>
<p>First, let’s get the data and add a column that tells us whether it’s a Christmas song or not</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">### get the data and add yes/no column.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>christmas <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(<span class="st">""</span>, <span class="st">"5OP7itTh52BMfZS1DJrdlv"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>christmas<span class="sc">$</span>christmas <span class="ot">&lt;-</span> <span class="st">"yes"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>not <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(<span class="st">""</span>, <span class="st">"6i2Qd6OpeRBAzxfscNXeWp"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>not<span class="sc">$</span>christmas <span class="ot">&lt;-</span> <span class="st">"no"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="do">## combine the two datasets and get the columns we want to use.</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>christmas_subset <span class="ot">&lt;-</span><span class="fu">rbind</span>(christmas, not)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>christmas_subset <span class="ot">&lt;-</span> christmas_subset <span class="sc">|&gt;</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"christmas"</span>, <span class="st">"acousticness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can use the <code>createDataPartition</code> function from the <code>caret</code> library to create a testing and a training dataset. Here, I’ve chosen a 70/30 partition of training and testing, but you can adjust as you see fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Train <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(christmas_subset<span class="sc">$</span>christmas, <span class="at">p=</span><span class="fl">0.7</span>, <span class="at">list=</span><span class="cn">FALSE</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> christmas_subset[ Train, ]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>testing <span class="ot">&lt;-</span> christmas_subset[ <span class="sc">-</span>Train, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can pretty easily implement something like a neural network, using our training dataset to train it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mod_fit <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(christmas <span class="sc">~</span> .,  </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>training, <span class="at">method=</span><span class="st">"nnet"</span>, <span class="at">importance =</span> <span class="st">"christmas"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we’ve trained this model, we can test it on our testing dataset, and see how well it does:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_fit, testing)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pred, <span class="fu">as.factor</span>(testing<span class="sc">$</span>christmas), <span class="at">positive =</span> <span class="st">"yes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction no yes
       no  20  14
       yes 15  16
                                          
               Accuracy : 0.5538          
                 95% CI : (0.4253, 0.6773)
    No Information Rate : 0.5385          
    P-Value [Acc &gt; NIR] : 0.4518          
                                          
                  Kappa : 0.1045          
                                          
 Mcnemar's Test P-Value : 1.0000          
                                          
            Sensitivity : 0.5333          
            Specificity : 0.5714          
         Pos Pred Value : 0.5161          
         Neg Pred Value : 0.5882          
             Prevalence : 0.4615          
         Detection Rate : 0.2462          
   Detection Prevalence : 0.4769          
      Balanced Accuracy : 0.5524          
                                          
       'Positive' Class : yes             
                                          </code></pre>
</div>
</div>
<p>So what does this all mean? Let’s define some terms.</p>
<ul>
<li><strong>Accuracy:</strong>
<ul>
<li>the accuracy rate. Just how many things it got right.</li>
</ul></li>
<li><strong>95% CI:</strong>
<ul>
<li>the confidence interval of the accuracy.</li>
</ul></li>
<li><strong>No information rate:</strong>
<ul>
<li>given no more information other than the overall distribution, how likely are you to be correct if you just pick the “majority class.”</li>
<li>if you have an accuracy rate of 80%, but the majority class is 80%, then your model isn’t terribly useful.</li>
</ul></li>
<li><strong>P-Value:</strong>
<ul>
<li>likelihood of chance.</li>
</ul></li>
<li><strong>Kappa:</strong>
<ul>
<li>measures the agreement between two raters and ratings. Here it’s looking at the difference between observed accuracy and random chance given the distribution in the dataset.</li>
</ul></li>
<li><strong>McNemar’s Test P-Value:</strong>
<ul>
<li>this is looking at the two distributions (from a 2x2 table), and determines if they are significantly different,</li>
</ul></li>
<li><strong>Sensitivity:</strong>
<ul>
<li>given that a result is actually a thing, what is the probability that our model will predict that event’s results?</li>
</ul></li>
<li><strong>Specificity:</strong>
<ul>
<li>given that a result is <em>not</em> actually a thing, what is the probability that our model will predict that?</li>
</ul></li>
<li><strong>Pos Predictive Value:</strong>
<ul>
<li>the probability that a predicted ‘positive’ class is actually positive.</li>
</ul></li>
<li><strong>Neg Predictive Value:</strong>
<ul>
<li>the probability that a predicted ‘negative’ class is actually negative.</li>
</ul></li>
<li><strong>Prevalence:</strong>
<ul>
<li>the prevalence of the ‘positive event’</li>
</ul></li>
<li><strong>Detection Rate:</strong>
<ul>
<li>the rate of true events also predicted to be events</li>
</ul></li>
<li><strong>Detection Prevalence</strong>
<ul>
<li>the prevalence of predicted events</li>
</ul></li>
<li><strong>Balanced Accuracy:</strong>
<ul>
<li>the average of the proportion corrects of each class individually</li>
</ul></li>
</ul>
<section id="what-is-the-model-using" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-model-using">What is the model using?</h3>
<p>We can look at which features the model is using…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">varImp</span>(mod_fit))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<ol type="1">
<li>Use PCA to explore the works of two artists. How well do they “separate”?</li>
<li>Run a classifier on two groups (it can be the same two artists, or two distinct groups). How well does your model do?</li>
</ol>
<p>Today we are going to look at different models and evaluating models. Our research question will be training a model to decipher John Lennon songs from Paul McCartney songs with various classifiers.</p>
</section>
</section>
<section id="john-or-paul" class="level1">
<h1>John or Paul?</h1>
<p>Our research process will follow a simple trajectory:</p>
<ul>
<li>Get songs by each artist’s solo career (this can be our ‘ground truth’, as it were).</li>
<li>Train the model on these pieces, and evaluate the various models.</li>
<li>Apply the various models to some songs by the Beatles.</li>
</ul>
<section id="getting-the-data" class="level2">
<h2 class="anchored" data-anchor-id="getting-the-data">Getting the Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>john <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'john lennon'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>paul <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'paul mccartney'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(john, paul)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is the balance of pieces like? It looks like we have far more McCartney than Lennon pieces. What does this mean for our model?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(both<span class="sc">$</span>artist_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   John Lennon Paul McCartney 
           584            984 </code></pre>
</div>
</div>
<p>We then can grab only the features that we want to explore for this model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>both_subset <span class="ot">&lt;-</span> both <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_name"</span>, <span class="st">"acousticness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before running a clustering, PCA, or a classifier such as a k-nearest neighbor, it’s probably good to standardize your data. This means that the data is consistent, and prevents wide ranges from dominating the results. Here we’ve scaled all of our data with the z-score of the data according with the rest of the data for that category.</p>
<p>I’ve also (temporarily) split the data from the artist, and then brought it all back together with cbind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> both_subset[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>artists <span class="ot">&lt;-</span> both_subset[,<span class="dv">1</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span>(<span class="fu">scale</span>(.) <span class="sc">%&gt;%</span> as.vector))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>both_artists <span class="ot">&lt;-</span> <span class="fu">cbind</span>(artists, data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation">Cross-Validation</h2>
<p>Cross-validation splits the data up into a testing and training set, and evaluates it.</p>
<section id="k-folds-cross-validation" class="level3">
<h3 class="anchored" data-anchor-id="k-folds-cross-validation">K-folds cross validation:</h3>
<p>K refers to the number of groups that data is split into.</p>
<ul>
<li>It randomizes the data</li>
<li>splits it into the specified number of groups</li>
<li>for each group, split into a training and testing set, and then evaluate</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>, <span class="at">number =</span> <span class="dv">2</span>, <span class="at">savePredictions =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Train <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(both_artists<span class="sc">$</span>artists, <span class="at">p=</span><span class="fl">0.7</span>, <span class="at">list=</span><span class="cn">FALSE</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>training <span class="ot">&lt;-</span> both_artists[ Train, ]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>testing <span class="ot">&lt;-</span> both_artists[ <span class="sc">-</span>Train, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at our results with a logistic regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mod_fit <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> .,  <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"glm"</span>, <span class="at">family=</span><span class="st">"binomial"</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl =</span> ctrl, <span class="at">tuneLength =</span> <span class="dv">10</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>testing<span class="sc">$</span>artists <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testing<span class="sc">$</span>artists)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_fit, <span class="at">newdata=</span>testing)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data=</span>pred, testing<span class="sc">$</span>artists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                Reference
Prediction       John Lennon Paul McCartney
  John Lennon             75             48
  Paul McCartney         100            247
                                         
               Accuracy : 0.6851         
                 95% CI : (0.641, 0.7269)
    No Information Rate : 0.6277         
    P-Value [Acc &gt; NIR] : 0.00533        
                                         
                  Kappa : 0.283          
                                         
 Mcnemar's Test P-Value : 2.763e-05      
                                         
            Sensitivity : 0.4286         
            Specificity : 0.8373         
         Pos Pred Value : 0.6098         
         Neg Pred Value : 0.7118         
             Prevalence : 0.3723         
         Detection Rate : 0.1596         
   Detection Prevalence : 0.2617         
      Balanced Accuracy : 0.6329         
                                         
       'Positive' Class : John Lennon    
                                         </code></pre>
</div>
</div>
<p>It looks like the accuracy is about 76%, but pay attention to the <em>sensitivity</em> and the <em>specificity</em> values.</p>
<p>Recall that sensitivity is a measurement of how well the model can detect a “positive” instance, and specificity measures how well the model is finding true negatives.</p>
<p>Sensitivity can be defined as follows:</p>
<blockquote class="blockquote">
<p>Sensitivity = (True Positive)/(True Positive + False Negative)</p>
</blockquote>
<p>and specificity can be defined as follows:</p>
<blockquote class="blockquote">
<p>Specificity = (True Negative)/(True Negative + False Positive)</p>
</blockquote>
<p>So this model is quite good at finding the negative class (here defined as McCartney), but not great at finding the positive class (Lennon).</p>
</section>
</section>
<section id="other-models" class="level2">
<h2 class="anchored" data-anchor-id="other-models">Other Models</h2>
<p>Let’s run the same code again, but now with a k-nearest neighbor. For our sanity, let’s put it into a function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>model_evaluation <span class="ot">&lt;-</span> <span class="cf">function</span>(method){</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    Train <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(both_artists<span class="sc">$</span>artists, <span class="at">p=</span><span class="fl">0.7</span>, <span class="at">list=</span><span class="cn">FALSE</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    training <span class="ot">&lt;-</span> both_artists[ Train, ]</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    testing <span class="ot">&lt;-</span> both_artists[ <span class="sc">-</span>Train, ]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    mod_fit <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> .,  </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data=</span>training, <span class="at">method=</span>method)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_fit, <span class="at">newdata=</span>testing)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(pred, testing[,<span class="st">"artists"</span>])</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">diag</span>(accuracy))<span class="sc">/</span><span class="fu">sum</span>(accuracy)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    testing<span class="sc">$</span>artists <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(testing<span class="sc">$</span>artists)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">confusionMatrix</span>(<span class="at">data=</span>pred, testing<span class="sc">$</span>artists)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">model_evaluation</span>(<span class="st">"kknn"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                Reference
Prediction       John Lennon Paul McCartney
  John Lennon            114             68
  Paul McCartney          61            227
                                          
               Accuracy : 0.7255          
                 95% CI : (0.6828, 0.7654)
    No Information Rate : 0.6277          
    P-Value [Acc &gt; NIR] : 4.645e-06       
                                          
                  Kappa : 0.4175          
                                          
 Mcnemar's Test P-Value : 0.5973          
                                          
            Sensitivity : 0.6514          
            Specificity : 0.7695          
         Pos Pred Value : 0.6264          
         Neg Pred Value : 0.7882          
             Prevalence : 0.3723          
         Detection Rate : 0.2426          
   Detection Prevalence : 0.3872          
      Balanced Accuracy : 0.7105          
                                          
       'Positive' Class : John Lennon     
                                          </code></pre>
</div>
</div>
<p>Note that it performs quite well! It’s better at finding the “John Lennon” model.</p>
<p>Why do we think this model performed better? A comparison of models can be found <a href="https://towardsdatascience.com/comparative-study-on-classic-machine-learning-algorithms-24f9ff6ab222">here</a>.</p>
<section id="neural-net" class="level3">
<h3 class="anchored" data-anchor-id="neural-net">Neural Net</h3>
<p>A neural net doesn’t seem to do as well.</p>
<div class="cell" data-messages="false">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">model_evaluation</span>(<span class="st">"nnet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models">Comparing Models</h2>
<ul>
<li>Logistic Regression</li>
<li>K-nearest neighbor</li>
<li>neural net</li>
<li>Learning Vector Quantization</li>
<li>gradient boosted machine</li>
<li>support vector machine</li>
</ul>
<p>We can train different models explicitly (without a function) for now.</p>
<div class="cell" data-messages="false">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>, <span class="at">number=</span><span class="dv">10</span>, <span class="at">repeats=</span><span class="dv">3</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># train logistic regression</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>modelglm <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> ., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"glm"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># train knn</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>modelknn <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> ., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"kknn"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># train nnet</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>modelnnet <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> ., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"nnet"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># train the LVQ model</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>modelLvq <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> ., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"lvq"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># train the GBM model</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>modelGbm <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span> ., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"gbm"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># train the SVM model</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>modelSvm <span class="ot">&lt;-</span> <span class="fu">train</span>(artists <span class="sc">~</span>., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"svmRadial"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="co"># train the random forest</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>randomforest <span class="ot">&lt;-</span> <span class="fu">train</span>(artists<span class="sc">~</span>., <span class="at">data=</span>both_artists, <span class="at">method=</span><span class="st">"ranger"</span>, <span class="at">trControl=</span>control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can actually look at the resampling of the dataset for each model, and get the results for each model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># collect resamples</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">resamples</span>(<span class="fu">list</span>(<span class="at">LVQ=</span>modelLvq, <span class="at">GBM=</span>modelGbm, <span class="at">SVM=</span>modelSvm,<span class="at">knn=</span>modelknn, <span class="at">nnet=</span>modelnnet, <span class="at">glm=</span>modelglm, <span class="at">rf=</span>randomforest))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the distributions</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = results)

Models: LVQ, GBM, SVM, knn, nnet, glm, rf 
Number of resamples: 30 

Accuracy 
          Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
LVQ  0.6050955 0.6415973 0.6602564 0.6600220 0.6751592 0.7133758    0
GBM  0.6962025 0.7439980 0.7619124 0.7663809 0.7878695 0.8397436    0
SVM  0.6687898 0.7179487 0.7388535 0.7387526 0.7687306 0.8012821    0
knn  0.7324841 0.7647041 0.7809603 0.7832078 0.8012821 0.8333333    0
nnet 0.6794872 0.7208987 0.7324841 0.7363845 0.7527715 0.8076923    0
glm  0.6089744 0.6634820 0.6858974 0.6862284 0.7099359 0.7594937    0
rf   0.7388535 0.8028602 0.8210844 0.8237734 0.8450584 0.9050633    0

Kappa 
           Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
LVQ  0.08665105 0.1683163 0.2101309 0.2206380 0.2633926 0.3847244    0
GBM  0.32297804 0.4362291 0.4827239 0.4877173 0.5394920 0.6557203    0
SVM  0.27879859 0.3771507 0.4167157 0.4276538 0.4885911 0.5730932    0
knn  0.42590980 0.4981390 0.5401244 0.5399265 0.5824790 0.6505858    0
nnet 0.29398986 0.3882580 0.4259220 0.4245391 0.4615117 0.5824411    0
glm  0.07503888 0.2320983 0.2821086 0.2882337 0.3352471 0.4441770    0
rf   0.44522968 0.5735189 0.6111771 0.6168420 0.6640556 0.7935900    0</code></pre>
</div>
</div>
<p>It might be better to look at the accuracy for each model. Here we have the accuracy rating as well as Cohen’s Kappa, which is like accuracy but also incorporates the imbalance of the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplots of results</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Here’s another plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dot plots of results</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Is it possible to use this for a research question??</p>
<p>What if we use our neural net model but on a different dataset? How about the beatles dataset that is available on Spotify (which admittedly isn’t as much as we’d like).</p>
<section id="grabbing-beatles-data" class="level3">
<h3 class="anchored" data-anchor-id="grabbing-beatles-data">Grabbing Beatles Data</h3>
<p>We can start by getting the data from Spotify:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>beatles <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'the beatles'</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>beatles_subset <span class="ot">&lt;-</span> beatles <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"artist_name"</span>, <span class="st">"acousticness"</span>, <span class="st">"energy"</span>, <span class="st">"instrumentalness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicting" class="level3">
<h3 class="anchored" data-anchor-id="predicting">Predicting</h3>
<p>Now we can use the models that we’ve trained, but on new data. Here we use the k-nearest neighbor models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>beatles_knn <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelknn, <span class="at">newdata=</span>beatles_subset)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>beatles_nnet <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelnnet, <span class="at">newdata=</span>beatles_subset)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>beatles_glm <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelglm, <span class="at">newdata=</span>beatles_subset)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>beatles_svm <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelSvm, <span class="at">newdata=</span>beatles_subset) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we are going to create a data frame of the track name, and the results from the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>classified_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(beatles_knn, beatles_nnet, beatles_glm, beatles_svm, beatles<span class="sc">$</span>track_name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(Note that this table doesn’t seem to be rendering correctly when pushed online).</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>What I like about this is that we can take something about authorship that we know, and then use it to explore authorship of things that are a little more ambiguous. It can also teach us a fair bit about the specific models. Why do we think some performed so much better than others?</p>
<section id="exercise-1" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1">Exercise:</h3>
<p>Let’s try to build an east/west coast rap classifier (an outdated concept, I know):</p>
<p>Here are some important steps for us to go through as we think about training a classifier:</p>
<ul>
<li>Grab data</li>
<li>partition and train model</li>
<li>compare models</li>
<li>use it to predict a new dataset.</li>
</ul>
<section id="lets-grab-the-data." class="level4">
<h4 class="anchored" data-anchor-id="lets-grab-the-data.">Let’s grab the data.</h4>
<p>Here I’m going to grab two playlists, one about “East coast” rap, and the other about “West coast”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>east_coast <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(<span class="st">""</span>, <span class="st">"3pu8tsqTW52aUtYFZN3g4A"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>east_coast<span class="sc">$</span>coast <span class="ot">&lt;-</span> <span class="st">"east"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>west_coast <span class="ot">&lt;-</span> <span class="fu">get_playlist_audio_features</span>(<span class="st">""</span>, <span class="st">"6lAOSVxxvGuEhPtZguaeav"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>west_coast<span class="sc">$</span>coast <span class="ot">&lt;-</span> <span class="st">"west"</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(east_coast, west_coast)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="do">####standardize and clean a bit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I’m going to grab the features that are important to me. Here it’s the “coast” variable, followed by the standard “global features” that the Spotify API provides.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> both <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"coast"</span>, <span class="st">"acousticness"</span>, <span class="st">"energy"</span>, <span class="st">"instrumentalness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> both[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>coast <span class="ot">&lt;-</span> both[,<span class="dv">1</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span>(<span class="fu">scale</span>(.) <span class="sc">%&gt;%</span> as.vector))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coast, data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we can run a k-folds cross-validation:</p>
<p>Here, the data is split into 10 subsets (or folds), and trains on k-1 of the folds (here 9), and tested on 1 of them. Then it repeats it a few times. In this case, 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>, <span class="at">number=</span><span class="dv">10</span>, <span class="at">repeats=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here we can run the cross-validation with different types of classifiers and plot the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># train logistic regression</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>modelglm <span class="ot">&lt;-</span> <span class="fu">train</span>(coast <span class="sc">~</span> ., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"glm"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># train knn</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>modelknn <span class="ot">&lt;-</span> <span class="fu">train</span>(coast <span class="sc">~</span> ., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"kknn"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># train nnet</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>modelnnet <span class="ot">&lt;-</span> <span class="fu">train</span>(coast <span class="sc">~</span> ., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"nnet"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># train the LVQ model</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>modelLvq <span class="ot">&lt;-</span> <span class="fu">train</span>(coast <span class="sc">~</span> ., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"lvq"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># train the GBM model</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>modelGbm <span class="ot">&lt;-</span> <span class="fu">train</span>(coast <span class="sc">~</span> ., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"gbm"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># train the SVM model</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>modelSvm <span class="ot">&lt;-</span> <span class="fu">train</span>(coast <span class="sc">~</span>., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"svmRadial"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># train the random forest</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>randomforest <span class="ot">&lt;-</span> <span class="fu">train</span>(coast<span class="sc">~</span>., <span class="at">data=</span>both, <span class="at">method=</span><span class="st">"ranger"</span>, <span class="at">trControl=</span>control)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="co"># collect resamples</span></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">resamples</span>(<span class="fu">list</span>(<span class="at">LVQ=</span>modelLvq, <span class="at">GBM=</span>modelGbm, <span class="at">SVM=</span>modelSvm,<span class="at">knn=</span>modelknn, <span class="at">nnet=</span>modelnnet, <span class="at">glm=</span>modelglm, <span class="at">rf=</span>randomforest))</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the distributions</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results)</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="week_7_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we can test our model on a dataset from outside of our initial training/testing stage:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>kendrick_data <span class="ot">&lt;-</span> <span class="fu">get_artist_audio_features</span>(<span class="st">'kendrick lamar'</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>kendrick <span class="ot">&lt;-</span> kendrick_data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"acousticness"</span>, <span class="st">"energy"</span>, <span class="st">"instrumentalness"</span>, <span class="st">"liveness"</span>, <span class="st">"danceability"</span>, <span class="st">"loudness"</span>, <span class="st">"speechiness"</span>, <span class="st">"valence"</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>kendrick <span class="ot">&lt;-</span> kendrick <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span>(<span class="fu">scale</span>(.) <span class="sc">%&gt;%</span> as.vector))</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>kendrick_rf <span class="ot">&lt;-</span> <span class="fu">predict</span>(randomforest, <span class="at">newdata=</span>kendrick)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>kendrick_knn <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelknn, <span class="at">newdata=</span>kendrick)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>kendrick_nnet <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelnnet, <span class="at">newdata=</span>kendrick)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(kendrick_rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>kendrick_rf
east west 
 107   35 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>classified_data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(kendrick_rf, kendrick_knn, kendrick_nnet, kendrick_data<span class="sc">$</span>track_name))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>classified_data<span class="sc">$</span>kendrick_knn <span class="ot">&lt;-</span> <span class="fu">if_else</span>(classified_data<span class="sc">$</span>kendrick_knn <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"West"</span>, <span class="st">"East"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>classified_data<span class="sc">$</span>kendrick_rf <span class="ot">&lt;-</span> <span class="fu">if_else</span>(classified_data<span class="sc">$</span>kendrick_rf <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"West"</span>, <span class="st">"East"</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>classified_data<span class="sc">$</span>kendrick_nnet <span class="ot">&lt;-</span> <span class="fu">if_else</span>(classified_data<span class="sc">$</span>kendrick_nnet <span class="sc">==</span> <span class="dv">2</span>, <span class="st">"West"</span>, <span class="st">"East"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>classified_data<span class="sc">$</span>track_name <span class="ot">&lt;-</span> kendrick<span class="sc">$</span>track_name</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>classified_data <span class="sc">|&gt;</span> <span class="fu">datatable</span>(<span class="at">filter =</span><span class="st">"top"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-66b9d89fd925b94f54c1" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-66b9d89fd925b94f54c1">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142"],["East","West","East","East","East","East","East","East","East","West","West","East","East","East","East","East","East","East","East","East","West","East","West","East","East","West","East","East","East","West","East","East","West","East","West","East","East","East","East","West","West","West","East","East","East","East","West","West","East","East","East","East","West","West","West","East","East","East","East","West","East","East","East","East","East","East","West","East","East","East","East","West","East","West","East","West","West","East","East","West","East","East","East","East","East","East","West","East","East","West","East","East","East","East","East","East","East","West","West","East","West","East","East","West","East","East","West","East","East","East","East","East","East","East","East","East","East","East","West","East","West","East","East","East","East","East","West","East","East","East","East","East","East","West","East","East","East","East","East","East","East","East"],["East","West","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","West","East","West","East","West","East","East","West","East","East","East","West","East","West","West","East","East","East","East","East","East","West","East","East","East","East","West","West","East","East","West","West","East","East","East","East","West","East","East","East","East","East","East","East","East","West","West","East","East","East","East","East","East","West","East","West","East","West","West","East","West","West","East","East","West","East","East","East","East","East","East","East","East","East","East","East","East","West","East","West","West","East","West","East","East","East","East","East","East","East","East","East","East","East","West","East","East","West","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","East","West","East","East","West","East","East","West"],["East","West","East","East","East","East","West","East","East","West","East","West","East","East","East","East","East","West","East","East","West","East","West","East","East","West","East","East","East","West","East","West","West","East","West","East","East","West","East","West","West","West","East","East","East","East","East","East","East","East","East","East","West","West","West","East","West","East","East","West","East","East","East","East","East","East","West","East","West","East","East","West","East","West","East","West","East","East","East","West","East","East","East","East","East","East","West","East","East","West","East","East","East","East","East","East","East","West","West","East","West","East","East","West","East","East","West","East","East","East","East","East","East","East","East","East","East","East","West","East","East","East","East","East","East","East","East","West","East","East","East","East","East","West","East","East","East","East","West","East","East","East"],["United In Grief","N95","Worldwide Steppers","Die Hard","Father Time (feat. Sampha)","Rich - Interlude","Rich Spirit","We Cry Together","Purple Hearts","Count Me Out","Crown","Silent Hill","Savior - Interlude","Savior","Auntie Diaries","Mr. Morale","Mother I Sober (feat. Beth Gibbons of Portishead)","Mirror","The Heart Part 5","Black Panther","All The Stars (with SZA)","X (with 2 Chainz &amp; Saudi)","The Ways (with Swae Lee)","Opps (with Yugen Blakrok)","I Am","Paramedic!","Bloody Waters (with Anderson .Paak &amp; James Blake)","King's Dead (with Kendrick Lamar, Future &amp; James Blake)","Redemption Interlude","Redemption (with Babes Wodumo)","Seasons (with Sjava &amp; Reason)","Big Shot (with Travis Scott)","Pray For Me (with Kendrick Lamar)","DUCKWORTH.","GOD.","FEAR.","XXX. FEAT. U2.","LOVE. FEAT. ZACARI.","LUST.","HUMBLE.","PRIDE.","LOYALTY. FEAT. RIHANNA.","FEEL.","ELEMENT.","YAH.","DNA.","BLOOD.","BLOOD.","DNA.","YAH.","ELEMENT.","FEEL.","LOYALTY. FEAT. RIHANNA.","PRIDE.","HUMBLE.","LUST.","LOVE. FEAT. ZACARI.","XXX. FEAT. U2.","FEAR.","GOD.","DUCKWORTH.","untitled 01 | 08.19.2014.","untitled 02 | 06.23.2014.","untitled 03 | 05.28.2013.","untitled 04 | 08.14.2014.","untitled 05 | 09.21.2014.","untitled 06 | 06.30.2014.","untitled 07 | 2014 - 2016","untitled 08 | 09.06.2014.","Wesley's Theory","For Free? - Interlude","King Kunta","Institutionalized","These Walls","u","Alright","For Sale? - Interlude","Momma","Hood Politics","How Much A Dollar Cost","Complexion (A Zulu Love)","The Blacker The Berry","You Ain't Gotta Lie (Momma Said)","i","Mortal Man","Sherane a.k.a Master Splinter’s Daughter","Bitch, Don’t Kill My Vibe","Backseat Freestyle","The Art of Peer Pressure","Money Trees","Poetic Justice","good kid","m.A.A.d city","Swimming Pools (Drank) - Extended Version","Sing About Me, I'm Dying Of Thirst","Real","Compton","The Recipe - Bonus Track","Black Boy Fly - Bonus Track","Now Or Never - Bonus Track","The Recipe (Black Hippy Remix) - Bonus Track","Bitch, Don’t Kill My Vibe - Remix","Sherane a.k.a Master Splinter’s Daughter","Bitch, Don’t Kill My Vibe","Backseat Freestyle","The Art of Peer Pressure","Money Trees","Poetic Justice","good kid","m.A.A.d city","Swimming Pools (Drank) - Extended Version","Sing About Me, I'm Dying Of Thirst","Real","Compton","Bitch, Don’t Kill My Vibe - Remix","F*ck Your Ethnicity","Hol' Up","A.D.H.D","No Make-Up (Her Vice) (feat. Colin Munroe)","Tammy's Song (Her Evils)","Chapter Six","Ronald Reagan Era","Poe Mans Dreams (His Vice) (feat. GLC)","Chapter Ten","Keisha's Song (Her Pain) (feat. Ashtro Bot)","Rigamortus","Kush &amp; Corinthians (feat. BJ The Chicago Kid)","Blow My High (Members Only)","Ab-Souls Outro (feat. Ab-Soul)","HiiiPower","Growing Apart (To Get Closer)","Ignorance Is Bliss","P&amp;P 1.5","Alien Girl (Today W/ Her)","Opposites Attract (Tomorrow W/O Her)","Michael Jordan","R.O.T.C (Interlude)","Barbed Wire","Average Joe","H.O.C","Cut You Off (To Grow Closer)","She Needs Me (Remix)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>kendrick_rf<\/th>\n      <th>kendrick_knn<\/th>\n      <th>kendrick_nnet<\/th>\n      <th>V4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Please note that this is a totally ridiculous classifier for Kendrick Lamar, but hopefully it demonstrates some possible techniques.</p>
<p>What would be a better research question?</p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../class_notes/week_6.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Week 6: Regression and Clustering</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2024, Daniel Shanahan</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>